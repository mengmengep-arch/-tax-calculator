<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏†‡∏≤‡∏©‡∏µ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-case {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-case h3 {
            margin-top: 0;
            color: #333;
        }
        .result {
            background: #e8f5e9;
            padding: 10px;
            border-left: 4px solid #4caf50;
            margin: 10px 0;
        }
        .expected {
            background: #fff3e0;
            padding: 10px;
            border-left: 4px solid #ff9800;
            margin: 10px 0;
        }
        .pass {
            color: #4caf50;
            font-weight: bold;
        }
        .fail {
            color: #f44336;
            font-weight: bold;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        table td {
            padding: 8px;
            border-bottom: 1px solid #ddd;
        }
        table td:first-child {
            font-weight: 500;
            color: #666;
        }
        table td:last-child {
            text-align: right;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <h1>üß™ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏†‡∏≤‡∏©‡∏µ</h1>

    <div id="test-results"></div>

    <script>
        // ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏°‡∏≤‡∏à‡∏≤‡∏Å script.js
        const TAX_BRACKETS = [
            { min: 0, max: 150000, rate: 0 },
            { min: 150000, max: 300000, rate: 5 },
            { min: 300000, max: 500000, rate: 10 },
            { min: 500000, max: 750000, rate: 15 },
            { min: 750000, max: 1000000, rate: 20 },
            { min: 1000000, max: 2000000, rate: 25 },
            { min: 2000000, max: 5000000, rate: 30 },
            { min: 5000000, max: Infinity, rate: 35 }
        ];

        function formatNumber(num) {
            return num.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        function calculateTax(netIncome, totalDeduction) {
            const taxableIncome = Math.max(netIncome - totalDeduction, 0);
            let totalTax = 0;

            for (let bracket of TAX_BRACKETS) {
                if (taxableIncome <= bracket.min) break;

                // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ô‡∏µ‡πâ
                const incomeInBracket = Math.min(taxableIncome, bracket.max) - bracket.min;

                if (incomeInBracket > 0) {
                    const taxAtThisRate = incomeInBracket * (bracket.rate / 100);
                    totalTax += taxAtThisRate;
                }
            }

            return Math.round(totalTax);
        }

        function calculateTaxDetailed(netIncome, totalDeduction) {
            const taxableIncome = Math.max(netIncome - totalDeduction, 0);
            let totalTax = 0;
            let breakdown = [];

            for (let bracket of TAX_BRACKETS) {
                if (taxableIncome <= bracket.min) break;

                const incomeInBracket = Math.min(taxableIncome, bracket.max) - bracket.min;

                if (incomeInBracket > 0) {
                    const taxAtThisRate = incomeInBracket * (bracket.rate / 100);
                    totalTax += taxAtThisRate;
                    breakdown.push({
                        range: `${formatNumber(bracket.min + 1)} - ${formatNumber(bracket.max)}`,
                        rate: bracket.rate,
                        income: incomeInBracket,
                        tax: taxAtThisRate
                    });
                }
            }

            return { totalTax: Math.round(totalTax), breakdown };
        }

        // Test Cases
        const testCases = [
            {
                name: "‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏î‡∏™‡∏≠‡∏ö 1: ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 50,000/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô + ‡πÇ‡∏ö‡∏ô‡∏±‡∏™ 100,000",
                salary: 50000,
                bonus: 100000,
                deductions: 69000,
                expectedTax: 32150
            },
            {
                name: "‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏î‡∏™‡∏≠‡∏ö 2: ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 30,000/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏ö‡∏ô‡∏±‡∏™",
                salary: 30000,
                bonus: 0,
                deductions: 69000,
                expectedTax: 4550
            },
            {
                name: "‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏î‡∏™‡∏≠‡∏ö 3: ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 100,000/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô + ‡πÇ‡∏ö‡∏ô‡∏±‡∏™ 200,000",
                salary: 100000,
                bonus: 200000,
                deductions: 69000,
                expectedTax: 161150
            },
            {
                name: "‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏î‡∏™‡∏≠‡∏ö 4: ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ï‡πà‡∏≥ (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ)",
                salary: 15000,
                bonus: 0,
                deductions: 69000,
                expectedTax: 0
            }
        ];

        let resultsHTML = '';

        testCases.forEach((testCase, index) => {
            const totalIncome = (testCase.salary * 12) + testCase.bonus;
            const expenses = Math.min(totalIncome * 0.5, 100000);
            const netIncome = totalIncome - expenses;
            const taxableIncome = netIncome - testCase.deductions;

            const result = calculateTaxDetailed(netIncome, testCase.deductions);
            const actualTax = result.totalTax;
            const passed = actualTax === testCase.expectedTax;

            resultsHTML += `
                <div class="test-case">
                    <h3>${testCase.name}</h3>

                    <table>
                        <tr>
                            <td>‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô:</td>
                            <td>${formatNumber(testCase.salary)} ‡∏ö‡∏≤‡∏ó</td>
                        </tr>
                        <tr>
                            <td>‡πÇ‡∏ö‡∏ô‡∏±‡∏™/‡∏õ‡∏µ:</td>
                            <td>${formatNumber(testCase.bonus)} ‡∏ö‡∏≤‡∏ó</td>
                        </tr>
                        <tr>
                            <td>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏°/‡∏õ‡∏µ:</td>
                            <td>${formatNumber(totalIncome)} ‡∏ö‡∏≤‡∏ó</td>
                        </tr>
                        <tr>
                            <td>‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ 50% (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 100,000):</td>
                            <td>${formatNumber(expenses)} ‡∏ö‡∏≤‡∏ó</td>
                        </tr>
                        <tr>
                            <td>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏™‡∏∏‡∏ó‡∏ò‡∏¥:</td>
                            <td>${formatNumber(netIncome)} ‡∏ö‡∏≤‡∏ó</td>
                        </tr>
                        <tr>
                            <td>‡∏Ñ‡πà‡∏≤‡∏•‡∏î‡∏´‡∏¢‡πà‡∏≠‡∏ô:</td>
                            <td>${formatNumber(testCase.deductions)} ‡∏ö‡∏≤‡∏ó</td>
                        </tr>
                        <tr>
                            <td><strong>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏Å‡∏•‡∏î‡∏´‡∏¢‡πà‡∏≠‡∏ô:</strong></td>
                            <td><strong>${formatNumber(taxableIncome)} ‡∏ö‡∏≤‡∏ó</strong></td>
                        </tr>
                    </table>

                    <h4>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏†‡∏≤‡∏©‡∏µ:</h4>
                    <table>
                        ${result.breakdown.map(b => `
                            <tr>
                                <td>${b.range} (${b.rate}%)</td>
                                <td>${formatNumber(b.income)} √ó ${b.rate}% = ${formatNumber(b.tax)} ‡∏ö‡∏≤‡∏ó</td>
                            </tr>
                        `).join('')}
                    </table>

                    <div class="expected">
                        <strong>‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á:</strong> ${formatNumber(testCase.expectedTax)} ‡∏ö‡∏≤‡∏ó/‡∏õ‡∏µ
                        (${formatNumber(Math.round(testCase.expectedTax / 12))} ‡∏ö‡∏≤‡∏ó/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)
                    </div>

                    <div class="result">
                        <strong>‡∏ú‡∏•‡∏à‡∏≤‡∏Å‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°:</strong> ${formatNumber(actualTax)} ‡∏ö‡∏≤‡∏ó/‡∏õ‡∏µ
                        (${formatNumber(Math.round(actualTax / 12))} ‡∏ö‡∏≤‡∏ó/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)
                    </div>

                    <p class="${passed ? 'pass' : 'fail'}">
                        ${passed ? '‚úÖ PASS - ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!' : '‚ùå FAIL - ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á'}
                    </p>
                </div>
            `;
        });

        document.getElementById('test-results').innerHTML = resultsHTML;
    </script>
</body>
</html>
